# 📅 年間行事予定表アプリ

学校の年間行事予定表をExcelファイルから読み込み、視覚的に表示し、JSON・ICAL・CSV形式でエクスポートできるWebアプリケーションです。

## 🌟 主な機能

### 📁 Excelファイル読み込み
- ドラッグ&ドロップまたはファイル選択で簡単に読み込み
- 前期・後期シート自動認識
- 本科・専攻科スケジュールの同時読み込み

### 🎌 日本の祝日対応
- **固定祝日**: 元日、建国記念の日、天皇誕生日など
- **移動祝日**: 成人の日、海の日、敬老の日、スポーツの日（ハッピーマンデー）
- **計算祝日**: 春分の日、秋分の日（天文計算による自動算出）
- **振替休日**: 日曜日の祝日による振替休日を自動計算
- **国民の休日**: 祝日に挟まれた平日を自動認識
- カレンダー上で祝日を赤色で強調表示
- エクスポート時に祝日情報も含まれる

### 📊 データ表示
- **学校年度制対応**: 日本の学校年度（4月～3月）に完全対応
  - 年度選択: 「2026年度」= 2026年4月～2027年3月
  - 月の並び順: 4月始まり（4,5,6,...,12,1,2,3）
  - 統計情報: 年度ベースで集計
- カレンダー形式でスケジュールを視覚化
- 月別・年度別・学期別フィルタリング
- 本科/専攻科/両方の表示切替
- 曜日授業日カウント表示
- 統計情報の自動集計

### 💾 エクスポート機能
- **JSON形式**: プログラムで処理しやすい形式（祝日情報含む）
- **ICAL形式**: Googleカレンダー、Outlookなどに直接インポート可能
- **CSV形式**: Excel等の表計算ソフトで編集可能（祝日カラム付き）

## 🚀 使い方

### 1. アプリケーションを開く
ブラウザで `index.html` を開きます。

```bash
# ローカルサーバーを使う場合（推奨）
npx http-server -p 8080
```

または、直接 `index.html` をブラウザで開いてください。

### 2. Excelファイルを読み込む
- ファイルをドラッグ&ドロップエリアにドロップ
- または、エリアをクリックしてファイルを選択

### 3. データを閲覧
- カレンダービューで月別にスケジュールを確認
- フィルター機能で表示内容を絞り込み
- 統計情報で全体像を把握

### 4. データをエクスポート
- 必要な形式のボタンをクリックしてダウンロード

## 📋 対応するExcelファイル形式

### シート構成
- `20xx前期` シート
- `20xx後期` シート

### データ構造
| 列 | 内容 | 説明 |
|---|------|------|
| A列 | 日付 | 日にちの数値（1-31） |
| B, F, J, N, R, V列 | 曜日 | 曜日の表示 |
| C, G, K, O, S, W列 | 授業日カウント | その曜日の何回目の授業日か |
| D, H, L, P, T, X列 | 本科スケジュール | 本科学生向けの行事・授業情報 |
| E, I, M, Q, U, Y列 | 専攻科スケジュール | 専攻科学生向けの行事・授業情報 |

### 特殊記号
アプリは以下の記号を自動的に認識して変換します：

| 記号 | 意味 |
|-----|------|
| ● | 教職員会議 |
| ◆ | 高専教授会 |
| ■ | 運営会議 |
| ○ | コース会議(R) |
| △ | 全日休講 |
| □ | 一般科目系会議/コース会議(H) |

### 時限情報
以下の時限に対応しています：

- **1/2限（1限）**: 9:00～10:35
- **3/4限（2限）**: 10:45～12:20
- **5/6限（3限）**: 13:05～14:40
- **7/8限（4限）**: 14:50～16:25

## 🎨 デザインの特徴

### モダンUI
- グラデーション背景
- スムーズなアニメーション
- ホバーエフェクト
- レスポンシブデザイン

### カラーコーディング
- **土曜日**: 青系
- **日曜日**: 赤系
- **本科イベント**: 青のボーダー
- **専攻科イベント**: 紫のボーダー
- **会議**: オレンジのボーダー
- **休講**: 赤のボーダー

## 🛠️ 技術スタック

- **HTML5**: セマンティックマークアップ
- **CSS3**: 
  - CSS Variables（カスタムプロパティ）
  - Flexbox / Grid Layout
  - アニメーション / トランジション
- **JavaScript (ES6+)**:
  - Promise / Async-Await
  - Arrow Functions
  - Template Literals
  - Destructuring
- **SheetJS (xlsx)**: Excelファイル読み込みライブラリ

## 📦 ファイル構成

```
annual_schedule_app/
├── index.html      # メインHTMLファイル
├── styles.css      # スタイルシート
├── app.js          # メインJavaScript
└── README.md       # このファイル
```

## 🌐 ブラウザ対応

- Chrome 90+
- Firefox 88+
- Safari 14+
- Edge 90+

## 🔧 カスタマイズ

### 色の変更
`styles.css` の `:root` セクションでカラーパレットをカスタマイズできます：

```css
:root {
    --primary-blue: hsl(210, 100%, 56%);
    --secondary-purple: hsl(270, 70%, 60%);
    /* ... */
}
```

### 時限情報の変更
`app.js` の `TIME_SLOTS` 定数で時限情報を変更できます：

```javascript
const TIME_SLOTS = {
    '1': { start: '09:00', end: '10:35', label: '1/2限（1限）' },
    // ...
};
```

## 🐛 トラブルシューティング

### Excelファイルが読み込めない
- ファイル形式が `.xlsx` または `.xls` であることを確認
- シート名に「前期」または「後期」が含まれているか確認
- ブラウザのコンソールでエラーメッセージを確認

### カレンダーが表示されない
- ブラウザのJavaScriptが有効になっているか確認
- ブラウザの開発者ツールでエラーを確認

### エクスポートファイルが文字化けする
- CSVファイルはUTF-8 BOM付きで出力されます
- Excelで開く場合、「データ」→「テキストファイルから」で開くことを推奨

## 📝 ライセンス

このアプリケーションは教育目的で作成されています。
自由に使用・改変していただけます。

## 🤝 サポート

問題が発生した場合は、以下を確認してください：
1. ブラウザの開発者ツール（F12）でコンソールエラーを確認
2. Excelファイルのフォーマットが正しいか確認
3. 最新のブラウザを使用しているか確認

---

© 2026 年間行事予定表アプリ
